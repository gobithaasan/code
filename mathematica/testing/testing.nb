(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31853,        833]
NotebookOptionsPosition[     31451,        815]
NotebookOutlinePosition[     31799,        830]
CellTagsIndexPosition[     31756,        827]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<testing.m\>\""}], 
    "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<testing`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.6381565108499346`*^9, 3.6381565174936748`*^9}, {
   3.638156549727295*^9, 3.6381565809904795`*^9}, {3.6381569765343933`*^9, 
   3.6381569949913654`*^9}, 3.638257233054979*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"tx", "+", 
        RowBox[{"ty", " ", 
         RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tan", "[", "sxz", "]"}], "+", 
           RowBox[{
            RowBox[{"Tan", "[", "sxy", "]"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]y", "]"}]}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"px", " ", "tx"}], "+", 
        RowBox[{"ty", " ", 
         RowBox[{"(", 
          RowBox[{"py", "+", 
           RowBox[{"px", " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{"pz", "+", 
           RowBox[{"py", " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
           RowBox[{"px", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ty", "+", 
        RowBox[{"tz", " ", 
         RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]y", "]"}]}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"px", " ", "tx"}], "+", 
        RowBox[{"ty", " ", 
         RowBox[{"(", 
          RowBox[{"py", "+", 
           RowBox[{"px", " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{"pz", "+", 
           RowBox[{"py", " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
           RowBox[{"px", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"tz", "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]y", "]"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"px", " ", "tx"}], "+", 
        RowBox[{"ty", " ", 
         RowBox[{"(", 
          RowBox[{"py", "+", 
           RowBox[{"px", " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{"pz", "+", 
           RowBox[{"py", " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
           RowBox[{"px", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.638156604691619*^9, 3.6381566367831416`*^9}, {
  3.63815675139729*^9, 3.638156753271555*^9}, {3.63815703864802*^9, 
  3.6381570502616215`*^9}, {3.638159076679276*^9, 3.6381590972184505`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FactorExpression", "[", "exp", "]"}]], "Input",
 CellChangeTimes->{{3.638257242934616*^9, 3.638257246047942*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v37", " ", 
      RowBox[{"(", 
       RowBox[{"tx", "+", 
        RowBox[{"ty", " ", "v1"}], "+", 
        RowBox[{"tz", " ", "v11"}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v11", " ", "v18"}], "+", 
           RowBox[{"v1", " ", "v24"}], "+", 
           RowBox[{"v6", " ", "v8"}]}], ")"}], " ", "x"}], "+", 
        RowBox[{"sy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v11", " ", "v20"}], "+", 
           RowBox[{"v1", " ", "v25"}], "-", 
           RowBox[{"v7", " ", "v8"}]}], ")"}], " ", "y"}], "+", 
        RowBox[{"sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "v5"}], "+", 
           RowBox[{"v11", " ", "v3", " ", "v8"}], "-", 
           RowBox[{"v1", " ", "v4", " ", "v8"}]}], ")"}], " ", "z"}]}], 
       ")"}]}], ",", 
     RowBox[{"v37", " ", 
      RowBox[{"(", 
       RowBox[{"ty", "+", 
        RowBox[{"tz", " ", "v2"}], "+", 
        RowBox[{"sx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v18", " ", "v2"}], "+", "v24"}], ")"}], " ", "x"}], "+", 
        RowBox[{"sy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v2", " ", "v20"}], "+", "v25"}], ")"}], " ", "y"}], "+", 
        RowBox[{"sz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v2", " ", "v3", " ", "v8"}], "-", 
           RowBox[{"v4", " ", "v8"}]}], ")"}], " ", "z"}]}], ")"}]}], ",", 
     RowBox[{"v37", " ", 
      RowBox[{"(", 
       RowBox[{"tz", "+", 
        RowBox[{"sx", " ", "v18", " ", "x"}], "+", 
        RowBox[{"sy", " ", "v20", " ", "y"}], "+", 
        RowBox[{"sz", " ", "v3", " ", "v8", " ", "z"}]}], ")"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", 
        RowBox[{"Tan", "[", "sxy", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v2", ",", 
        RowBox[{"Tan", "[", "syz", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v3", ",", 
        RowBox[{"Cos", "[", "\[Theta]x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v4", ",", 
        RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v5", ",", 
        RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v6", ",", 
        RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v7", ",", 
        RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v8", ",", 
        RowBox[{"Cos", "[", "\[Theta]y", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v9", ",", 
        RowBox[{"v1", " ", "v2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v10", ",", 
        RowBox[{"Tan", "[", "sxz", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v11", ",", 
        RowBox[{"v10", "+", "v9"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v12", ",", 
        RowBox[{"px", " ", "v1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v13", ",", 
        RowBox[{"py", "+", "v12"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v14", ",", 
        RowBox[{"px", " ", "v11"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v15", ",", 
        RowBox[{"py", " ", "v2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v16", ",", 
        RowBox[{"pz", "+", "v14", "+", "v15"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v17", ",", 
        RowBox[{"v4", " ", "v7"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v18", ",", 
        RowBox[{"v17", "+", 
         RowBox[{"v3", " ", "v5", " ", "v6"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v19", ",", 
        RowBox[{"v4", " ", "v6"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v20", ",", 
        RowBox[{"v19", "-", 
         RowBox[{"v3", " ", "v5", " ", "v7"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v21", ",", 
        RowBox[{"v3", " ", "v7"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v22", ",", 
        RowBox[{"v17", " ", "v5"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v23", ",", 
        RowBox[{"v3", " ", "v6"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v24", ",", 
        RowBox[{"v21", "-", 
         RowBox[{"v19", " ", "v5"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v25", ",", 
        RowBox[{"v22", "+", "v23"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v26", ",", 
        RowBox[{"px", " ", "tx"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v27", ",", 
        RowBox[{"ty", " ", "v13"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v28", ",", 
        RowBox[{"tz", " ", "v16"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v29", ",", 
        RowBox[{"v16", " ", "v18"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v30", ",", 
        RowBox[{"v13", " ", "v24"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v31", ",", 
        RowBox[{"v29", "+", "v30", "+", 
         RowBox[{"px", " ", "v6", " ", "v8"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v32", ",", 
        RowBox[{"v16", " ", "v20"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v33", ",", 
        RowBox[{"v13", " ", "v25"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v34", ",", 
        RowBox[{"v32", "+", "v33", "-", 
         RowBox[{"px", " ", "v7", " ", "v8"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v35", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "px"}], " ", "v5"}], "+", 
         RowBox[{"v16", " ", "v3", " ", "v8"}], "-", 
         RowBox[{"v13", " ", "v4", " ", "v8"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v36", ",", 
        RowBox[{"1", "+", "v26", "+", "v27", "+", "v28", "+", 
         RowBox[{"sx", " ", "v31", " ", "x"}], "+", 
         RowBox[{"sy", " ", "v34", " ", "y"}], "+", 
         RowBox[{"sz", " ", "v35", " ", "z"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"v37", ",", 
        FractionBox["1", "v36"]}], "}"}]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6382574583676987`*^9}]
}, Open  ]]
},
WindowSize->{1080, 1847},
WindowMargins->{{Automatic, -1088}, {-351, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 481, 10, 52, "Input"],
Cell[1042, 32, 23986, 593, 672, "Input"],
Cell[CellGroupData[{
Cell[25053, 629, 137, 2, 31, "Input"],
Cell[25193, 633, 6242, 179, 203, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
