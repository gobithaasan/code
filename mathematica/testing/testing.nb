(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30063,        771]
NotebookOptionsPosition[     29340,        744]
NotebookOutlinePosition[     29688,        759]
CellTagsIndexPosition[     29645,        756]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<testing.m\>\""}], 
    "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<testing`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.6381565108499346`*^9, 3.6381565174936748`*^9}, {
   3.638156549727295*^9, 3.6381565809904795`*^9}, {3.6381569765343933`*^9, 
   3.6381569949913654`*^9}, 3.638257233054979*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"tx", "+", 
        RowBox[{"ty", " ", 
         RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Tan", "[", "sxz", "]"}], "+", 
           RowBox[{
            RowBox[{"Tan", "[", "sxy", "]"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]y", "]"}]}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"px", " ", "tx"}], "+", 
        RowBox[{"ty", " ", 
         RowBox[{"(", 
          RowBox[{"py", "+", 
           RowBox[{"px", " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{"pz", "+", 
           RowBox[{"py", " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
           RowBox[{"px", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ty", "+", 
        RowBox[{"tz", " ", 
         RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]y", "]"}]}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"px", " ", "tx"}], "+", 
        RowBox[{"ty", " ", 
         RowBox[{"(", 
          RowBox[{"py", "+", 
           RowBox[{"px", " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{"pz", "+", 
           RowBox[{"py", " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
           RowBox[{"px", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"tz", "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Theta]y", "]"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"px", " ", "tx"}], "+", 
        RowBox[{"ty", " ", 
         RowBox[{"(", 
          RowBox[{"py", "+", 
           RowBox[{"px", " ", 
            RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"tz", " ", 
         RowBox[{"(", 
          RowBox[{"pz", "+", 
           RowBox[{"py", " ", 
            RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
           RowBox[{"px", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tan", "[", "sxz", "]"}], "+", 
              RowBox[{
               RowBox[{"Tan", "[", "sxy", "]"}], " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"sz", " ", "z", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sx", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"px", " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"sy", " ", "y", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "px"}], " ", 
            RowBox[{"Cos", "[", "\[Theta]y", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Theta]z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Cos", "[", "\[Theta]z", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"py", "+", 
              RowBox[{"px", " ", 
               RowBox[{"Tan", "[", "sxy", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]z", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]x", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Theta]x", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]y", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]z", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"pz", "+", 
              RowBox[{"py", " ", 
               RowBox[{"Tan", "[", "syz", "]"}]}], "+", 
              RowBox[{"px", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Tan", "[", "sxz", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Tan", "[", "sxy", "]"}], " ", 
                  RowBox[{"Tan", "[", "syz", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.638156604691619*^9, 3.6381566367831416`*^9}, {
  3.63815675139729*^9, 3.638156753271555*^9}, {3.63815703864802*^9, 
  3.6381570502616215`*^9}, {3.638159076679276*^9, 3.6381590972184505`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FactorExpression", "[", "Null", "]"}]], "Input",
 CellChangeTimes->{{3.638257242934616*^9, 3.638257246047942*^9}, {
  3.6382578494879646`*^9, 3.6382578500504656`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"First", "::", "nofirst"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({}\\)\[NoBreak] has a length of zero and \
no first element. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/First\\\", ButtonNote -> \
\\\"First::nofirst\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6382578507644773`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Tally", "::", "list"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"List expected at position \[NoBreak]\\!\\(1\\)\[NoBreak] \
in \[NoBreak]\\!\\(Tally[\\(\\(First[\\(\\({}\\)\\)]\\)\\)]\\)\[NoBreak]. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/list\\\", \
ButtonNote -> \\\"Tally::list\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6382578508876877`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Tally", "::", "list"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"List expected at position \[NoBreak]\\!\\(1\\)\[NoBreak] \
in \[NoBreak]\\!\\(Tally[\\(\\(First[\\(\\({}\\)\\)]\\)\\)]\\)\[NoBreak]. \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/list\\\", \
ButtonNote -> \\\"Tally::list\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6382578509814405`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"MaximalBy", "::", "arg1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The first argument is expected to be a list or \
association. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/MaximalBy\\\", ButtonNote -> \\\"MaximalBy::arg1\\\
\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638257851187977*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "shape"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Lists \[NoBreak]\\!\\({testing`Private`factor$56892, \
testing`Private`count$56892}\\)\[NoBreak] and \
\[NoBreak]\\!\\(Tally[\\(\\(First[\\(\\({}\\)\\)]\\)\\)]\\)\[NoBreak] are not \
the same shape. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638257851250124*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"testing`Private`count$56892", ">", "1"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"testing`Private`newVar$", ",", "testing`Private`newExp$"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{"testing`Private`newVar$", "=", 
         RowBox[{"Symbol", "[", 
          RowBox[{"\<\"v\"\>", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"0", "+", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"Sow", "[", 
         RowBox[{"{", 
          RowBox[{
          "testing`Private`newVar$", ",", "testing`Private`factor$56891"}], 
          "}"}], "]"}], ";", 
        RowBox[{"testing`Private`newExp$", "=", 
         RowBox[{"Null", "/.", "\[VeryThinSpace]", 
          RowBox[{
          "testing`Private`factor$56891", "\[Rule]", 
           "testing`Private`newVar$"}]}]}], ";", 
        RowBox[{"testing`Private`factorExpression", "[", 
         RowBox[{"testing`Private`newExp$", ",", 
          RowBox[{"0", "+", "1"}]}], "]"}]}]}], "]"}], ",", "Null"}], "]"}], 
   ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6382574583676987`*^9, 3.6382578512530527`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "testing`factorExpression", "]"}]], "Input",
 CellChangeTimes->{{3.6382578895453405`*^9, 3.6382579005477133`*^9}}],

Cell[BoxData[
 InterpretationBox["Null",
  Definition[testing`factorExpression],
  Editable->False]], "Output",
 CellChangeTimes->{3.6382579010164776`*^9}]
}, Open  ]]
},
WindowSize->{1080, 1847},
WindowMargins->{{Automatic, -1088}, {-351, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 481, 10, 52, "Input"],
Cell[1042, 32, 23986, 593, 672, "Input"],
Cell[CellGroupData[{
Cell[25053, 629, 191, 3, 31, "Input"],
Cell[25247, 634, 445, 10, 21, "Message"],
Cell[25695, 646, 510, 10, 21, "Message"],
Cell[26208, 658, 510, 10, 21, "Message"],
Cell[26721, 670, 434, 10, 21, "Message"],
Cell[27158, 682, 569, 12, 21, "Message"],
Cell[27730, 696, 1243, 32, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29010, 733, 156, 2, 31, "Input"],
Cell[29169, 737, 155, 4, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
